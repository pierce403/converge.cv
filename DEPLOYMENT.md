# Deployment Guide for Converge.cv

## GitHub Pages Setup

This app is configured to deploy automatically to GitHub Pages via GitHub Actions.

### Initial Setup

1. **Enable GitHub Pages:**
   - Go to your repository settings
   - Navigate to "Pages" section
   - Source: "GitHub Actions"

2. **Update Vite Base Path (if needed):**
   If deploying to a subdirectory, update `vite.config.ts`:
   ```ts
   export default defineConfig({
     base: '/converge.cv/', // or just '/' for custom domain
     // ... rest of config
   });
   ```

3. **Custom Domain (Optional):**
   - Add a `CNAME` file to the `public/` directory with your domain
   - Configure DNS with your domain provider:
     - For apex domain (converge.cv): A records to GitHub IPs
     - For www subdomain: CNAME to `username.github.io`

### Automatic Deployment

Every push to the `main` branch triggers:
1. TypeScript type checking
2. ESLint code quality checks
3. Production build
4. Deployment to GitHub Pages

The workflow is defined in `.github/workflows/deploy.yml`.

### Manual Deployment

To deploy manually:

```bash
# Build the project
pnpm build

# The dist/ folder contains the production build
# Deploy contents to your hosting provider
```

## Environment Variables

For production, you'll need to set up:

### VAPID Keys for Push Notifications

Generate VAPID keys for Web Push:

```bash
npx web-push generate-vapid-keys
```

Update `src/lib/sw-bridge/index.ts` with your public key:
```ts
const vapidPublicKey = 'YOUR_PUBLIC_KEY_HERE';
```

Store the private key securely on your push notification server.

### XMTP Configuration

When integrating real XMTP SDK:
- Update `src/lib/xmtp/client.ts` with actual XMTP v3 client code
- Configure XMTP network (dev/production)
- Set up any required API keys or endpoints

## PWA Features

### Service Worker

The service worker is automatically generated by `vite-plugin-pwa` and handles:
- Offline app shell caching
- Static asset caching
- Push notification reception

### Installability

For the app to be installable:
1. Served over HTTPS (GitHub Pages handles this)
2. Has a valid manifest.webmanifest
3. Has a registered service worker
4. Meets PWA criteria (Lighthouse audit)

### Icons

Replace placeholder icons in `public/icons/` with proper app icons:
- `icon-192.png` - 192x192 PNG
- `icon-512.png` - 512x512 PNG

Generate icons from a source image:
```bash
# Using ImageMagick or similar tool
convert source-icon.png -resize 192x192 public/icons/icon-192.png
convert source-icon.png -resize 512x512 public/icons/icon-512.png
```

## Post-Deployment Checklist

- [ ] Verify HTTPS is working
- [ ] Test PWA installation on mobile devices
- [ ] Run Lighthouse audit for PWA compliance
- [ ] Test offline functionality
- [ ] Verify service worker registration
- [ ] Test push notifications (if enabled)
- [ ] Check responsive design on various screen sizes
- [ ] Validate manifest.webmanifest
- [ ] Test on iOS Safari and Android Chrome
- [ ] Verify all routes work correctly
- [ ] Test authentication flow
- [ ] Verify encrypted storage works

## Monitoring & Analytics

Consider adding:
- Error tracking (Sentry, etc.)
- Analytics (Plausible, Fathom, etc.)
- Performance monitoring
- User feedback collection

## Security Notes

- All message encryption happens client-side
- Vault keys never leave the device
- No user data is sent to backend (unless you add XMTP relay)
- IndexedDB stores encrypted messages only
- Passphrase/passkey required to decrypt

## Troubleshooting

### Service Worker Not Updating

Clear browser cache and reload, or:
```js
navigator.serviceWorker.getRegistrations().then(registrations => {
  registrations.forEach(reg => reg.unregister())
});
```

### PWA Not Installing

- Check browser console for errors
- Verify manifest.webmanifest is accessible
- Ensure HTTPS is working
- Check Lighthouse PWA audit

### Build Failures

Check GitHub Actions logs for details. Common issues:
- TypeScript errors
- ESLint violations
- Missing dependencies

---

**Deployment Domain:** https://converge.cv  
**Repository:** https://github.com/pierce403/converge.cv  
**Status:** [![Build Status](https://github.com/pierce403/converge.cv/workflows/Build%20and%20Deploy%20to%20GitHub%20Pages/badge.svg)](https://github.com/pierce403/converge.cv/actions)

